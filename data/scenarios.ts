import { Scenario } from '@/types';
import type { Lang } from '@/lib/translations';
import { scenariosEn } from './scenariosEn';

// サンプルシナリオデータ
export const sampleScenario: Scenario = {
  id: 'scenario-001',
  difficulty: 'easy',
  title: '外部からのメール受信',
  description: 'あなたは会社でメールを確認しています。以下のシナリオから情報セキュリティ上の危険ポイントを見つけてください。',
  situation: `
月曜日の朝、あなたのメールボックスに取引先の担当者から「緊急:請求書の修正について」という件名のメールが届きました。

メール本文:
「お世話になっております。先日送付した請求書に誤りがありました。
添付ファイルの修正版をご確認いただき、早急に経理部門へ転送をお願いいたします。
また、パスワードは別途SMS でお送りしますので、解凍してご確認ください。」

添付ファイル: 請求書_修正版.zip

送信元メールアドレス: tanaka@examp1e-company.com
（いつもの担当者は tanaka@example-company.com）

あなたは急いでいたため、すぐに添付ファイルを開こうとしています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-001',
      text: '送信元のメールアドレスが普段と異なる（examp1e の"l"が数字の"1"になっている）',
      isCorrect: true,
      explanation: '正解です。シナリオでは送信元が tanaka@examp1e-company.com とあり、普段の tanaka@example-company.com と異なります。正規ドメインに似せた偽ドメインで、フィッシングでよく使われる手口のため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-002',
      text: 'ZIP形式の添付ファイルがある',
      isCorrect: true,
      explanation: '正解です。シナリオでは「請求書_修正版.zip」が添付されており、パスワードは別途SMSで送るとあります。ZIPとパスワード付きはマルウェア隠しやセキュリティスキャン回避に使われることが多いため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-003',
      text: 'パスワードをSMSで送ると書かれている',
      isCorrect: true,
      explanation: '正解です。シナリオのメール本文に「パスワードは別途SMSでお送りします」とあります。業務でパスワードをSMS送付する運用は稀で、パスワード付きファイルは正規チェックを回避する目的で使われることが多いため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-004',
      text: '「緊急」という言葉で焦らせている',
      isCorrect: true,
      explanation: '正解です。シナリオの件名は「緊急:請求書の修正について」で、本文で「早急に」と催促しています。攻撃者は焦りで確認を省略させようとするため、この表現は危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005',
      text: 'メールの文面が丁寧で問題ない',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは確かに「お世話になっております」など丁寧な文面ですが、丁寧さだけでは安全性は判断できません。送信元の偽装・添付・緊急表現などが危険の判断材料であり、この選択は正しい危険ポイントではありません。'
    },
    {
      id: 'point-006',
      text: '取引先からのメールなので信頼できる',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは取引先担当者を装ったメールの可能性が高く、送信元アドレスが普段と異なります。見かけで信頼せず送信元と内容を確認すべきであり、「取引先だから信頼できる」は危険ポイントの正しい選択ではありません。'
    }
  ]
};

// 2つ目のサンプルシナリオ（公共Wi-Fi・USB）
export const sampleScenario2: Scenario = {
  id: 'scenario-002',
  difficulty: 'easy',
  title: '出張先での作業',
  description: 'あなたは出張先のカフェで作業しています。以下のシナリオから情報セキュリティ上の危険ポイントを見つけてください。',
  situation: `
出張先のカフェに到着したあなたは、明日の会議資料を仕上げる必要があります。

カフェのフリーWi-Fiに接続し、クラウドストレージから資料をダウンロードして編集を始めました。
隣の席の人が「USBメモリを落としましたか？」と声をかけてきて、見覚えのないUSBメモリを差し出してきました。
「いえ、違います」と答えると、その人は「じゃあ誰かの忘れ物ですね。使えるかもしれませんよ」と言ってテーブルに置いていきました。

あなたは作業に集中するため、そのUSBメモリは気にせず、編集した資料をクラウドにアップロードしてメールで送信しようとしています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-201',
      text: 'フリーWi-Fiでクラウドやメールにアクセスしている',
      isCorrect: true,
      explanation: '正解です。シナリオではカフェのフリーWi-Fiに接続し、クラウドから資料をダウンロードして編集し、メールで送ろうとしています。公共Wi-Fiは盗聴・中間者攻撃のリスクがあるため、機密資料のやり取りとしては危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-202',
      text: '見知らぬ人から渡されたUSBメモリがテーブルに置かれたまま',
      isCorrect: true,
      explanation: '正解です。シナリオでは隣の席の人が見知らぬUSBメモリをテーブルに置いていきました。不正なUSB（マルウェア入り等）を置いていく手口があるため、そのままにしている状態は危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-203',
      text: '編集した資料をその場で送信しようとしている',
      isCorrect: true,
      explanation: '正解です。シナリオでは編集した資料をクラウドにアップロードしてメールで送信しようとしています。公共の場での画面覗き見（ショルダーハッキング）のリスクがあるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-204',
      text: 'カフェで作業している',
      isCorrect: false,
      explanation: '誤選択です。シナリオではカフェで作業していますが、危険なのは「場所」ではなく、そこでフリーWi-Fiを使う・見知らぬUSBが置かれている・画面を見られうる環境で送信するなどの「扱い方」です。カフェにいること自体は危険ポイントとしては当てはまりません。'
    },
    {
      id: 'point-205',
      text: 'クラウドストレージを使って作業を行っている',
      isCorrect: false,
      explanation: '誤選択です。クラウドストレージの利用そのものは危険とは言えません。危険なのはフリーWi-Fi経路です。シナリオではフリーWi-Fiでクラウドストレージにアクセスしており盗聴のリスクがありますが、「クラウドストレージを使って作業を行っている」こと自体は危険ポイントではありません。'
    }
  ]
};

// 3つ目のシナリオ（情報セキュリティマネジメント 科目B 題材：クラウド導入・委託先管理）
export const sampleScenario3: Scenario = {
  id: 'scenario-003',
  difficulty: 'easy',
  title: 'クラウドサービス導入と委託先への情報提供',
  description: '情報セキュリティマネジメント試験 科目B を題材にしたシナリオです。業務でクラウドサービスを導入し、委託先にデータを渡す際の危険ポイントを見つけてください。',
  situation: `
あなたの部門では、既存システムの改修プロジェクトが本格的に動き始めました。
プロジェクトでは、社内外のメンバーが関わるため、データ共有の仕組みや委託先との連携方法を整える必要があります。
現在、次の2つの準備を同時に進めています。
- 外部の開発会社 B社 にシステム改修を委託する
- プロジェクトメンバーやB社とのデータ共有のため、A社のクラウド型ファイル共有サービスを導入する
あなたはプロジェクト担当者として、A社・B社それぞれと打ち合わせを行い、運用方法の確認を進めています。

【A社：クラウドサービス導入の説明】
A社の担当者から、サービスの概要として次の説明がありました。
- 無料トライアルで、すぐに利用開始できる
- 初期設定のパスワードは担当者へメールで送付する
- 管理者アカウントは1名で運用可能
- データは海外のデータセンターにも保存される場合がある
- ログインはIDとパスワードのみで、2要素認証は任意
このクラウドサービスは、プロジェクト資料や顧客データのサンプルをB社と共有する際にも利用する予定です。

【B社：委託先への情報提供（上司からの指示）】
システム改修を担当するB社には、次のように情報を渡すよう上司から指示がありました。
- 顧客マスタのサンプルデータを、明日の打ち合わせでUSBメモリで手渡しする
- 機密保持契約（NDA）は、開発が始まってから締結する予定
- B社との連絡は、これまで通りメールとチャットアプリ（ログは残らない設定）で行う
あなたは、A社のクラウド導入とB社への情報提供の準備を進めながら、プロジェクト全体の進行に必要な情報を整理しています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-301',
      text: '初期設定のパスワードをメールで送付している',
      isCorrect: true,
      explanation: '正解です。シナリオでは「初期設定のパスワードは担当者へメールで送付する」とあります。メールは盗聴・漏洩のリスクがあり認証情報の送付に不適切なため、危険ポイントとして正しく選べています。メールは暗号化されていない経路で届くため途中傍受の恐れがあり、認証情報の受け渡しには専用ポータルや秘密トークなど、より安全な手段の利用を検討すべきです。'
    },
    {
      id: 'point-302',
      text: '管理者アカウントが1名のみで運用されている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「管理者アカウントは1名で運用可能」とあります。単独運用はパスワード漏洩時や不在時にリスクが高まるため、危険ポイントとして正しく選べています。管理者が1人だけだと不在時や事故時の対応が難しくなるため、複数で役割を分担する運用を検討するとよいでしょう。'
    },
    {
      id: 'point-309',
      text: 'クラウド型ファイル共有サービスを業務で利用しようとしている',
      isCorrect: false,
      explanation: '誤選択です。シナリオではA社のクラウド型ファイル共有サービスを導入するとありますが、危険なのはクラウド利用そのものではなく、パスワードのメール送付・2要素認証が任意・海外保存・セキュリティ確認前の即利用といった運用内容です。クラウドを利用すること自体は危険ポイントとしては当てはまりません。'
    },
    {
      id: 'point-303',
      text: 'データが海外のデータセンターに保存される可能性がある',
      isCorrect: true,
      explanation: '正解です。シナリオでは「データは海外のデータセンターにも保存される場合がある」とあります。個人情報・機密の域外保存は法やガイドラインで制限される場合があるため、危険ポイントとして正しく選べています。個人情報保護法や業界ガイドラインでは域外保存に条件が付くことがあり、保存先国によっては現地法令によるアクセスが発生しうる点にも注意が必要です。'
    },
    {
      id: 'point-304',
      text: 'ログインがIDとパスワードのみで、2要素認証が任意になっている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「ログインはIDとパスワードのみで、2要素認証は任意」とあります。2要素認証が任意だとパスワード漏洩時の不正ログインリスクが高まるため、危険ポイントとして正しく選べています。SMSや認証アプリによる2要素認証を必須にすれば、パスワード漏洩時にも不正アクセスを防ぎやすくなります。'
    },
    {
      id: 'point-305',
      text: '無料トライアルで即利用開始しようとしている（セキュリティ確認前）',
      isCorrect: true,
      explanation: '正解です。シナリオでは「無料トライアルで、すぐに利用開始できる」とあります。セキュリティ要件の確認や評価の前に利用を始めると、後から問題が見つかっても対応が遅れるため、危険ポイントとして正しく選べています。特に顧客データを扱う場合は、事前のセキュリティ評価や契約内容の確認を済ませてから導入を検討するのが望ましいです。'
    },
    {
      id: 'point-306',
      text: '顧客マスタのサンプルデータをUSBメモリで手渡ししようとしている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「顧客マスタのサンプルデータを、明日の打ち合わせでUSBメモリで手渡しする」とあります。USBは紛失・盗難のリスクが高く、危険ポイントとして正しく選べています。USBメモリは小型で置き忘れや紛失が起きやすく、手渡しだと配送記録も残りにくいため、暗号化やアクセス記録が残る手段の利用を検討するのがよいでしょう。'
    },
    {
      id: 'point-311',
      text: '開発用にサンプルデータを準備しようとしている',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは顧客マスタのサンプルをB社に渡すとありますが、危険なのはサンプルデータを準備すること自体ではなく、USBでの手渡しやNDA締結前に渡すという方法・タイミングです。開発に必要な範囲でサンプルを用意することは業務上必要なことであり、そのこと自体は危険ポイントとしては当てはまりません。'
    },
    {
      id: 'point-307',
      text: '機密保持契約（NDA）を開発開始後に締結する予定になっている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「機密保持契約（NDA）は、開発が始まってから締結する予定」とあります。機密を渡す前にNDAを締結しておく必要があり、後では渡した時点で保護が不十分なため、危険ポイントとして正しく選べています。情報を渡す前に契約で守秘義務や違反時の責任を定めておけば、万一の漏洩時に法的な対応がしやすくなります。'
    },
    {
      id: 'point-308',
      text: 'チャットアプリがログを残さない設定のまま利用されている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「チャットアプリ（ログは残らない設定）」とあります。委託先との連絡でログが残らないと証跡が残らず監査・事後確認ができないため、危険ポイントとして正しく選べています。委託先とのやり取りでは、指示内容や共有範囲の記録を残せる手段の利用を検討するとよいでしょう。'
    },
    {
      id: 'point-310',
      text: 'B社との連絡にチャットアプリを利用しようとしている',
      isCorrect: false,
      explanation: '誤選択です。シナリオではB社との連絡にチャットを使うとありますが、危険なのはチャット利用そのものではなく、ログが残らない設定で使っている点です。証跡が残る運用であれば、委託先との連絡にチャットを使うこと自体は問題ありません。チャットを利用すること自体は危険ポイントとしては当てはまりません。'
    }
  ]
};

// 4つ目のシナリオ（委託先に個人情報リストを渡す際のリスク）
export const sampleScenario4: Scenario = {
  id: 'scenario-004',
  difficulty: 'easy',
  title: '委託先への個人情報リストの提供',
  description: 'あなたは委託先に個人情報リストを渡す業務を担当しています。以下のシナリオから情報セキュリティ上の危険ポイントを見つけてください。',
  situation: `
あなたの部門では、顧客向けDM発送を外部の委託先であるC社に依頼することになりました。
C社とは長年、印刷物の制作や封入作業などの業務で取引がありますが、個人情報を扱うDM発送業務を依頼するのは今回が初めてです。
上司からは「C社に送付用の個人情報リストを渡してほしい」と指示されています。

【現在の手順（上司の説明）】
・リストはExcelで作成し、メールに添付してC社担当者に送る
・C社とは長年の付き合いがあるため、DM発送に関する委託契約や秘密保持契約は「後でまとめて締結する予定」
・リストには氏名・住所・電話番号に加え、過去の購入履歴も含めて渡す（「C社が分析に使うかも」とのこと）
・作業完了後のリストの返却や削除については、特に取り決めがない

【C社担当者からの連絡】
・「ファイルが重いので、パスワード"1234"でZIP暗号化して送ってください」というメッセージが届いた

あなたは、このままリストを渡してよいか確認したいと考えています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-403',
      text: '購入履歴など、DM発送に不要な情報もリストに含めて渡す予定である',
      isCorrect: true,
      explanation: '正解です。シナリオでは「過去の購入履歴も含めて渡す」とあり、DM発送に不要な情報を含めています。個人情報は委託業務に必要な範囲に限定すべきなため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-406',
      text: 'C社は長年の取引先なので信頼できる',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは印刷物制作や封入作業で長年取引があるとありますが、危険なのはメール送付・契約後締結・不要情報含む・返却削除の取り決めなし・弱いパスワードなどであり、取引歴があること自体は危険ポイントとしては当てはまりません。信頼で手続きを省略するのが問題です。'
    },
    {
      id: 'point-404',
      text: '作業完了後のリストの返却・削除の取り決めがない',
      isCorrect: true,
      explanation: '正解です。シナリオでは「作業完了後のリストの返却や削除については、特に取り決めがない」とあります。取り決めがないと委託先にデータが残り続けるリスクがあるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-401',
      text: '個人情報リストをメール添付で送る予定である',
      isCorrect: true,
      explanation: '正解です。シナリオでは「リストはExcelで作成し、メールに添付してC社担当者に送る」とあります。メールは盗聴・誤送信・転送のリスクがあり個人情報の送付に不適切なため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-407',
      text: 'Excelでリストを作成している',
      isCorrect: false,
      explanation: '誤選択です。シナリオではExcelでリストを作成するとありますが、危険なのは送付経路（メール添付）・契約の有無・提供範囲・返却削除の取り決め・パスワード強度などであり、Excel形式自体は危険ポイントとしては当てはまりません。'
    },
    {
      id: 'point-405',
      text: 'ZIPファイルのパスワードが「1234」のように推測されやすい',
      isCorrect: true,
      explanation: '正解です。シナリオではC社から「パスワード"1234"でZIP暗号化して送ってください」と連絡が来ています。個人情報を含むZIPのパスワードが弱いと第三者に不正解読されるリスクがあるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-402',
      text: '委託契約・秘密保持契約を「後で締結する」予定である',
      isCorrect: true,
      explanation: '正解です。シナリオでは委託契約や秘密保持契約は「後でまとめて締結する予定」とあります。個人情報を渡す前に契約を締結しておく必要があり、渡した時点では法的保護が不十分なため、危険ポイントとして正しく選べています。'
    }
  ]
};

// 5つ目のシナリオ：取引先への電子ファイル送付
export const sampleScenario005: Scenario = {
  id: 'scenario-005',
  difficulty: 'easy',
  title: '取引先への電子ファイル送付',
  description: 'あなたは、取引先に「今期の見積書」をメールで送るよう上司から依頼されました。以下のシナリオから情報セキュリティ上の危険ポイントを見つけてください。',
  situation: `
あなたは、取引先B社に「今期の見積書」をメールで送るよう上司から依頼されました。

あなたの手元には次のファイルがあります。
・見積書_2025Q1.xlsx
・見積書_2024Q4_社内検討用.xlsx

B社の担当者は以前は佐藤さん（sato@b-company.co.jp）でしたが、先月「担当が山田さんに変わります」という連絡が来ました。新担当者のメールアドレスはその連絡には記載されておらず、あなたの思い込みで「yamada@b-company.co.jp」とメモに書いています。そのメモの下には、別の取引先C社の「田村 tamura@c-company.co.jp」のメールアドレスも書かれています。

時間がなかったため、あなたは「見積書_2025Q1.xlsx」をファイル名だけで選んで添付し、件名を「【B社】今期見積書のご送付」にして、宛先に yamada@b-company.co.jp を入力しました。送信前に、同僚から「ファイルが重いから ZIP にしておいたほうがいいよ。パスワードは estimate2025 にして、本文に書いておけば大丈夫」とアドバイスされ、あなたはその通りパスワードをメール本文に追記して送信ボタンを押そうとしています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-501',
      text: '添付しようとしているファイルが「社内検討用」で、社内コメントやコスト内訳が含まれている可能性がある',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは「見積書_2025Q1.xlsx」を添付したと明記されており、社内検討用（見積書_2024Q4_社内検討用.xlsx）ではありません。したがってこの選択肢は状況に当てはまらず、危険ポイントとして正しい選択ではありません。'
    },
    {
      id: 'point-502',
      text: 'メモにB社とC社のアドレスが近くに書かれており、宛先の取り違えが起きやすい状態で送信しようとしている',
      isCorrect: true,
      explanation: '正解です。シナリオではメモに「yamada@b-company.co.jp」と書き、その下に「田村 tamura@c-company.co.jp」も書かれており、宛先の取り違えが起きやすい状態です。送信前に宛先の最終確認が重要であるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-503',
      text: 'パスワードを同じメールの本文に書いて送ろうとしている',
      isCorrect: true,
      explanation: '正解です。シナリオでは同僚に「パスワードは estimate2025 にして、本文に書いておけば大丈夫」とアドバイスされ、その通りメール本文にパスワードを追記して送ろうとしています。メールが漏えいするとパスワードも同時に漏れるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-504',
      text: '送信前に、添付ファイルが本当にB社向けの正しいファイルか中身まで確認していない',
      isCorrect: true,
      explanation: '正解です。シナリオでは「見積書_2025Q1.xlsx」をファイル名だけで選んで添付したとあり、中身を開いて確認した記述はありません。送付前には内容を確認すべきであるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-505',
      text: '担当者異動後、正式な連絡（メールや名刺）で山田さんのアドレスが正しいか確認していない',
      isCorrect: true,
      explanation: '正解です。シナリオでは新担当者のアドレスは連絡に記載されておらず、思い込みでメモに書いただけで、取引先からの正式なメールや名刺で宛先を確認した記述はありません。思い込みやメモだけでは転記ミス・誤った情報の可能性があるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-506',
      text: 'Excelで送るので、PDFにした方が安全だ',
      isCorrect: false,
      explanation: '誤選択です。シナリオではExcelファイルを送ろうとしていますが、危険なのはファイル形式ではなく、宛先の確認・パスワードの渡し方・添付内容の確認などです。ExcelかPDFかは本質的な危険ポイントではありません。'
    },
    {
      id: 'point-507',
      text: '見積書は機密ではないので、そのまま送ってよい',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは見積書を送ろうとしていますが、見積書には価格・条件など機密にすべき情報が含まれます。取引先向けでも取り扱いには注意が必要であり、「機密ではない」と判断することは危険ポイントの正しい選択ではありません。'
    }
  ]
};

// ========== 難しいシナリオ（各テーマの応用編） ==========

// 1の応用：メール（取引先を装った巧妙なBEC風）
export const sampleScenario001Hard: Scenario = {
  id: 'scenario-001-hard',
  difficulty: 'hard',
  title: '外部からのメール受信（応用）',
  description: '取引先を装ったメールが届きました。易しい版より手口が巧妙です。危険ポイントを見極めてください。',
  situation: `
月曜の朝、あなたのメールボックスには、人事から回ってきた「取引先・パートナー社の山田様が昨日付で退職されました」という共有が未読のまま届いています。あなたはまだ目を通していません。

そのような中、以下のメールが届きました。送信元は普段やり取りしているアドレス（yamada@partner-company.co.jp）と同一です。

────────────────────────────────────────
差出人: 山田 太郎 <yamada@partner-company.co.jp>
宛先: （あなたのメールアドレス）
日付: 2025年1月13日 9:02
件名: 【重要】請求書の振込先変更のご案内
添付: 振込先変更のご案内.pdf (1 file)
────────────────────────────────────────

お世話になっております。

経理部門の都合により、今期より振込先口座が変更となりました。
添付のPDFに新しい口座情報が記載されておりますので、今後のご請求分より新口座へお振込みいただけますと幸いです。
お手数ですが、1月20日までにご確認のうえ、社内手続きをお願いいたします。

パートナー株式会社
経理部 山田 太郎

────────────────────────────────────────

なお、振込先の変更については、社内マニュアルに「取引先から書面で正式通知が届くまで振込先は変更しない」と定められています。

あなたは件名の「重要」と期限に気を取られ、添付を開いて確認しようとしています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-001h-1',
      text: '振込先変更をメールと添付のみで依頼している',
      isCorrect: true,
      explanation: '正解です。シナリオでは振込先変更を「添付のPDFに新しい口座情報が記載されております」とメールと添付のみで依頼しています。正規では書面・複数経路での確認が一般的であり、この手口はBECの可能性が高いため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-001h-2',
      text: '「重要」「期限」で急かす表現がある',
      isCorrect: true,
      explanation: '正解です。シナリオの件名は「【重要】請求書の振込先変更のご案内」で、本文に「1月20日までにご確認のうえ」と期限があります。攻撃者は緊急性で確認を省略させようとするため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-001h-3',
      text: '送信元アドレスが普段と同一でも、送信者が別人の可能性がある',
      isCorrect: true,
      explanation: '正解です。シナリオでは人事共有で「山田様が昨日付で退職されました」とある一方、同じアドレス（yamada@partner-company.co.jp）からメールが届いています。偽装や乗っ取りで正規と同じアドレスから送れるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-001h-4',
      text: '社内マニュアル（書面での正式通知まで変更しない）に反する手順である',
      isCorrect: true,
      explanation: '正解です。シナリオでは社内マニュアルに「取引先から書面で正式通知が届くまで振込先は変更しない」とあるのに、メールと添付のみの依頼に応じようとしています。規定に反する手順のため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-001h-5',
      text: 'PDF形式なのでZIPより安全である',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは添付がPDFですが、危険なのはファイル形式ではなく「振込先変更をメール添付のみで依頼している」という手口です。PDFも悪用されるため、形式で安全と判断するのは危険ポイントの正しい選択ではありません。'
    },
    {
      id: 'point-001h-6',
      text: '取引先の正式なアドレスからなので信頼できる',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは送信元は普段と同じアドレスですが、退職通知が回っており別人が送っている可能性があります。アドレスが同じでも振込先変更は別経路で本人確認が必要であり、この選択は正しい危険ポイントではありません。'
    }
  ]
};

// 2の応用：出張先・リモート（ホテルWi-Fi・共有PC）
export const sampleScenario002Hard: Scenario = {
  id: 'scenario-002-hard',
  difficulty: 'hard',
  title: '出張先での作業（応用）',
  description: '出張先のホテルで作業しています。一見安全そうな環境にも危険が潜みます。危険ポイントを見つけてください。',
  situation: `
出張先のホテルに宿泊しているあなたは、翌日のプレゼン資料の最終確認をしています。

ホテルの「ゲスト用セキュアWi-Fi」に接続し、社内ポータルにログインして資料をダウンロードしました。
ルームに備え付けの「ビジネスセンター利用可」の案内に従い、フロントで借りたUSBメモリに資料をコピーし、1階のビジネスコーナーにある共用PCでプレゼン資料を開いて印刷しようとしています。
ビジネスコーナーには「ご利用後はログアウトしてください」と注意書きがあります。

あなたは時間がなく、共用PCに「ゲスト」という名前でログインしたまま、USBから資料を開いて印刷ボタンを押そうとしています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-002h-1',
      text: 'ホテルの「セキュアWi-Fi」でも、同じネットワークの他宿泊者がいる',
      isCorrect: true,
      explanation: '正解です。シナリオでは「ゲスト用セキュアWi-Fi」に接続して社内ポータルから資料をダウンロードしています。ゲスト用Wi-Fiは同一ネットワークに不特定多数がいるため盗聴のリスクがあり、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-002h-2',
      text: '共用PCで社内の機密資料を開いている',
      isCorrect: true,
      explanation: '正解です。シナリオではビジネスコーナーの共用PCでプレゼン資料を開いて印刷しようとしています。共用PCではキャッシュやキーロガーのリスクがあるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-002h-3',
      text: 'USBメモリをホテル経由で借りて社内資料をコピーしている',
      isCorrect: true,
      explanation: '正解です。シナリオではフロントで借りたUSBメモリに資料をコピーしています。貸出USBは不特定多数が使用するためマルウェアの可能性があり、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-002h-4',
      text: '「ゲスト」でログインしたまま資料を扱い、ログアウトしていない',
      isCorrect: true,
      explanation: '正解です。シナリオでは共用PCに「ゲスト」でログインしたまま、USBから資料を開いて印刷ボタンを押そうとしています。ログアウトせずに利用すると次の利用者に情報が残るため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-002h-5',
      text: 'ビジネスコーナーはホテル管理なので安全である',
      isCorrect: false,
      explanation: '誤選択です。シナリオではホテルのビジネスコーナーを利用していますが、危険なのは共用PC・共用ネットワーク・貸出USB・ログアウトしていない点であり、ホテル管理であること自体は危険ポイントとしては当てはまりません。'
    },
    {
      id: 'point-002h-6',
      text: '資料を印刷するだけなので読み取り専用で問題ない',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは印刷しようとしていますが、開いた時点でメモリやキャッシュにデータが残ります。読み取り専用でも共用PCで機密資料を開くこと自体がリスクであり、「印刷だけだから問題ない」は正しい危険ポイントの選択ではありません。'
    }
  ]
};

// 3の応用：クラウド・委託（サブプロセッサ・監査）
export const sampleScenario003Hard: Scenario = {
  id: 'scenario-003-hard',
  difficulty: 'hard',
  title: 'クラウドサービス導入と委託先への情報提供（応用）',
  description: 'クラウド契約と委託先管理が進んでいます。契約書や運用の「抜け」に注目して危険ポイントを見つけてください。',
  situation: `
クラウド型ファイル共有サービス（A社）の契約は締結済みで、委託先B社への顧客マスタ提供も、暗号化USBとNDA締結済みで行われています。

【追加で検討している運用】
・A社のサービスは、A社が「提携パートナー」として紹介する外部の分析ツール（D社）と連携でき、連携すると利用状況のレポートが自動で取得できる
・契約書には「A社およびA社が選定したサブプロセッサがデータを処理する」とあり、D社の名前やデータの扱いは個別には記載されていない
・B社との連絡は、B社の要望で「やり取りが早い」という理由で、ログが残るチャットから、ログが残らない別のチャットアプリに切り替えようとしている

あなたは、これらの運用をこのまま進めてよいか確認したいと考えています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-003h-1',
      text: 'サブプロセッサ（D社）が契約書に個別に明示されておらず、データの扱いが不明である',
      isCorrect: true,
      explanation: '正解です。シナリオでは契約書に「A社が選定したサブプロセッサがデータを処理する」とある一方、D社の名前やデータの扱いは記載されていません。サブプロセッサは契約で明示すべきなため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-003h-2',
      text: '「提携パートナー」の分析ツールにデータが渡る可能性がある',
      isCorrect: true,
      explanation: '正解です。シナリオではA社のサービスがD社の分析ツールと連携でき、連携すると利用状況レポートが自動取得できるとあります。社内データがD社に渡る可能性があるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-003h-3',
      text: 'B社との連絡をログが残らないチャットに切り替えようとしている',
      isCorrect: true,
      explanation: '正解です。シナリオでは「ログが残るチャットから、ログが残らない別のチャットアプリに切り替えようとしている」とあります。委託先との証跡が残らなくなるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-003h-4',
      text: 'B社の「やり取りが早い」という要望だけで通信手段を変更している',
      isCorrect: true,
      explanation: '正解です。シナリオではB社の「やり取りが早い」という理由だけでログが残らないツールに切り替えようとしています。利便性だけで証跡を残さない手段にするとコンプライアンス上問題になるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-003h-5',
      text: 'NDAと暗号化USBが済んでいるので問題ない',
      isCorrect: false,
      explanation: '誤選択です。シナリオではB社への提供はNDA・暗号化USBで行われていますが、危険なのはクラウドのD社連携・サブプロセッサの不明確さ・ログが残らないチャットへの切り替えです。B社部分が済んでいることだけでは今回のリスクは解消されず、この選択は正しくありません。'
    },
    {
      id: 'point-003h-6',
      text: 'A社が選定したパートナーなので安全である',
      isCorrect: false,
      explanation: '誤選択です。シナリオではD社はA社が紹介する提携パートナーですが、自社データが誰にどう渡るかは契約と設定で自ら確認すべきです。ベンダー選定だけで安全と判断するのは危険ポイントの正しい選択ではありません。'
    }
  ]
};

// 4の応用：個人情報リスト委託（再委託・目的外利用）
export const sampleScenario004Hard: Scenario = {
  id: 'scenario-004-hard',
  difficulty: 'hard',
  title: '委託先への個人情報リストの提供（応用）',
  description: '委託先へのリスト提供は、安全な経路と契約で行うようになりました。さらに踏み込んだ危険ポイントを見つけてください。',
  situation: `
委託先C社への個人情報リストの提供は、専用の安全なファイル転送サービスと、委託契約・秘密保持・個人情報取扱いの締結済みで行っています。リストはDM発送に必要な氏名・住所・送付先のみに限定しています。

【新たな依頼（上司からの説明）】
・C社から「同じ業種向けの別キャンペーンでもリストを流用したい。顧客区分（A/B/C）だけ追加で渡してほしい」と打診があった
・上司は「同じC社だし、区分だけなら渡してもよいのでは」と検討している
・リストの返却・削除は「委託契約の終了時」と契約に書いてあるが、今回の「別キャンペーンでの流用」は契約書の利用目的には「DM発送のため」としか書いていない

あなたは、この流用と区分の追加提供を許可してよいか確認したいと考えています。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-004h-1',
      text: '契約した利用目的（DM発送）以外のキャンペーンでリストを流用しようとしている',
      isCorrect: true,
      explanation: '正解です。シナリオではC社から「同じ業種向けの別キャンペーンでもリストを流用したい」と打診があります。契約の利用目的は「DM発送のため」のみであり、別キャンペーンは目的外利用のため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-004h-2',
      text: '「顧客区分」を追加で渡すことは、提供する個人データの範囲の変更である',
      isCorrect: true,
      explanation: '正解です。シナリオでは当初は氏名・住所・送付先のみだったのに、顧客区分（A/B/C）の追加提供が打診されています。提供データの範囲が変わるため契約の見直しが必要であり、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-004h-3',
      text: '契約書の利用目的に「別キャンペーンでの流用」が含まれていない',
      isCorrect: true,
      explanation: '正解です。シナリオでは契約書の利用目的は「DM発送のため」としか書いていないとあります。別キャンペーンでの流用は契約に含まれていないため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-004h-4',
      text: '「同じC社」という理由だけで追加提供を検討している',
      isCorrect: true,
      explanation: '正解です。シナリオでは上司が「同じC社だし、区分だけなら渡してもよいのでは」と検討しています。委託先が同じでも目的が違えば別の提供行為であり、この理由だけで判断するのは危険なため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-004h-5',
      text: '安全なファイル転送と契約が済んでいるので問題ない',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは安全な経路と契約で提供していますが、今回の「別キャンペーンでの流用」と「顧客区分の追加」は目的外・範囲拡大のリスクであり、経路が整っていることでは解消されません。この選択は正しい危険ポイントではありません。'
    },
    {
      id: 'point-004h-6',
      text: '顧客区分は個人を特定しないので提供してよい',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは顧客区分の追加が打診されていますが、氏名・住所と組み合わせれば個人を特定できるため、区分だけでは「個人を特定しない」とは言えません。目的と契約の範囲で検討すべきであり、この選択は正しくありません。'
    }
  ]
};

// 5の応用：取引先への電子ファイル送付（宛先・CC・届け先確認）
export const sampleScenario005Hard: Scenario = {
  id: 'scenario-005-hard',
  difficulty: 'hard',
  title: '取引先への電子ファイル送付（応用）',
  description: '取引先B社の新担当・山田さんに「契約書ドラフト」を送る依頼です。社内規定は守っていますが、宛先・届け先に落とし穴があります。危険ポイントを見極めてください。',
  situation: `
あなたは、取引先B社の新担当・山田さん（yamada@b-company.co.jp）に「契約書ドラフト」を送るよう依頼されています。社内規定で「機密ファイルはパスワード付きZIPで送り、パスワードは別メールまたは電話で伝える」と定められています。

あなたは次の手順で送付の準備をしました。
・送付するファイル「契約書ドラフト_B社向け.pdf」を開き、B社名・契約条件のみが記載されていることを確認した。
・ZIPにパスワード（Contract2025）を設定し、件名「【B社】契約書ドラフト送付」で yamada@b-company.co.jp を宛先に入力した。
・「パスワードは別送」と書いたメールを先に送信し、数分後にZIP添付メールを送信した。

送付後、B社の山田さんから「CCに yamada@b-company.co.jp が入っていました。私の正しいアドレスは yamada-t@b-company.co.jp（ハイフン付き）です。届いていればそちらで開きます」というメールが届きました。あなたは「CCに入れたのは誤りだったが、本人に届いたなら問題ない」と考え、特に上司や情報管理担当には報告していません。

一方、あなたのメモには「B社・山田 yamada@b-company.co.jp」と「B社・山田（別部署） yamada-t@b-company.co.jp」の両方が書かれており、過去のメール履歴では yamada@ あてに送った取引メールは、実は山田さんの同姓同名の別部署の方が受け取っていた可能性があります。
  `.trim(),
  dangerPoints: [
    {
      id: 'point-005h-1',
      text: '宛先に yamada@ を入力していたが、正しいアドレスは yamada-t@ であり、誤ったアドレスに機密ファイルを送っている可能性がある',
      isCorrect: true,
      explanation: '正解です。シナリオでは宛先に yamada@ を入力して送ったところ、山田さんから「私の正しいアドレスは yamada-t@（ハイフン付き）です」と連絡が来ています。誤ったアドレスに機密を送った可能性があるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-2',
      text: 'CCに本人のアドレスを入れており、CCの用途（写し送り）と「本人あて送付」が混同している',
      isCorrect: true,
      explanation: '正解です。シナリオでは山田さんから「CCに yamada@b-company.co.jp が入っていました」と指摘されています。本人あての送付でCCに宛先を入れるのは用途の混同であり、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-3',
      text: 'パスワードを「別メール」で送っているが、短時間で同じ相手に送っており、メールが漏えいした場合にセットで取得されるリスクがある',
      isCorrect: true,
      explanation: '正解です。シナリオでは「パスワードは別送」のメールを先に送信し、数分後にZIP添付メールを送っています。規定は満たしていますが同じ経路・短時間だと漏えい時にセットで取られるリスクがあるため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-4',
      text: '誤送信の可能性に気づいた後、上司や情報管理担当に報告・相談していない',
      isCorrect: true,
      explanation: '正解です。シナリオでは山田さんからCC誤りと正しいアドレスの連絡があった後、「特に上司や情報管理担当には報告していません」とあります。事後でも報告し再送・確認手続きを取るべきなため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-5',
      text: '「本人に届いたなら問題ない」と自己判断しており、届いたアドレス（yamada@）の受信者が本当に契約担当の山田さんか確認していない',
      isCorrect: true,
      explanation: '正解です。シナリオでは「本人に届いたなら問題ない」と考えていますが、メモには「B社・山田（別部署） yamada-t@」もあり、yamada@ には同姓同名の別部署の方が受け取っていた可能性があります。届け先の確認をしていないため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-6',
      text: 'メモに yamada@ と yamada-t@ の両方があるのに、送付前にどちらが今回の担当者か正式に確認していない',
      isCorrect: true,
      explanation: '正解です。シナリオではメモに「B社・山田 yamada@」と「B社・山田（別部署） yamada-t@」の両方が書かれています。送付前に正式な連絡で窓口を特定していないため、危険ポイントとして正しく選べています。'
    },
    {
      id: 'point-005h-7',
      text: 'PDFで送っているので、Wordより安全である',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは契約書ドラフトをPDFでZIP送付していますが、危険なのはファイル形式ではなく宛先の誤り・CCの混同・パスワードの渡し方・事後報告の欠如などです。PDFかWordかは本質的な危険ポイントではありません。'
    },
    {
      id: 'point-005h-8',
      text: '社内規定どおりパスワードを別送しているので問題ない',
      isCorrect: false,
      explanation: '誤選択です。シナリオでは規定どおりパスワードを別送していますが、同じメール経路・短時間で送っているため漏えい時にセットで取られるリスクが残ります。規定遵守だけでは実質的なリスクが解消されていないため、この選択は正しい危険ポイントではありません。'
    }
  ]
};

// 応用シナリオ（難しいシナリオ）をトップページに表示するかどうか
// true に変更すると応用シナリオが一覧に表示される
export const SHOW_HARD_SCENARIOS = false;

// 複数のシナリオを配列として管理（日本語）
export const scenarios: Scenario[] = [
  sampleScenario,
  sampleScenario2,
  sampleScenario3,
  sampleScenario4,
  sampleScenario005,
  sampleScenario001Hard,
  sampleScenario002Hard,
  sampleScenario003Hard,
  sampleScenario004Hard,
  sampleScenario005Hard,
];

// 言語に応じたシナリオ一覧を取得
export function getScenarios(lang: Lang): Scenario[] {
  return lang === 'en' ? scenariosEn : scenarios;
}

// id と言語からシナリオを取得するヘルパー
export function getScenarioById(id: string, lang?: Lang): Scenario | undefined {
  const list = lang === 'en' ? scenariosEn : scenarios;
  return list.find((s) => s.id === id);
}

// 易しい/難しいそれぞれのグループ内での連番（1始まり）を返す
export function getScenarioSequenceNumber(
  id: string,
  lang: Lang,
  difficulty: 'easy' | 'hard'
): number | undefined {
  const list = lang === 'en' ? scenariosEn : scenarios;
  const filtered = list.filter((s) => (s.difficulty ?? 'easy') === difficulty);
  const index = filtered.findIndex((s) => s.id === id);
  return index >= 0 ? index + 1 : undefined;
}
